@if (_uploading)
{
    <MudProgressCircular Color="Color.Primary" Size="Size.Large" Indeterminate="true" />
}
else
{
    <MudToolBar>
        <MudIconButton Class="ml-4" Variant="Variant.Filled" Icon="@Icons.Material.Filled.Refresh" Style="@($"color: {Colors.Shades.White}; background: {Colors.Pink.Default};")" OnClick="Refresh" />
        <InputFile id="fileInput" OnChange="UploadFiles" hidden multiple/>
        <MudButtonGroup Class="ml-4" Variant="Variant.Filled" Color="Color.Primary">
            <MudButton StartIcon="@Icons.Material.Filled.Add" HtmlTag="label" for="fileInput">Add</MudButton>
            <MudButton StartIcon="@Icons.Material.Filled.Remove" OnClick="RemoveSelectedMods">Remove</MudButton>
        </MudButtonGroup>
        <MudButtonGroup Class="ml-4" Variant="Variant.Filled" Color="Color.Primary">
            <MudButton StartIcon="@Icons.Material.Filled.Check" OnClick="@(() => ToggleMods(true))">Enable</MudButton>
            <MudButton StartIcon="@Icons.Material.Filled.Clear" OnClick="@(() => ToggleMods(false))">Disable</MudButton>
        </MudButtonGroup>
        <MudSpacer/>
        <MudIconButton Icon="@Icons.Material.Filled.Settings" OnClick="OpenSettingsDialog" />
    </MudToolBar>

    @if (_initialized)
    {
        <MudTable Square="true" Items="@_settings.Mods" Hover="true" MultiSelection="true" @bind-SelectedItems="_selectedMods">
            <ColGroup>
                <col/>
                <col/>
                <col/>
                <col/>
                <col/>
            </ColGroup>
            <HeaderContent>
                <MudTh>Enabled</MudTh>
                <MudTh>File name</MudTh>
                <MudTh>Size</MudTh>
                <MudTh># of Files</MudTh>
                <MudTh></MudTh>
            </HeaderContent>
            <RowTemplate>
                <MudTd><MudIcon Icon="@(context.Enabled ? Icons.Material.Filled.Check : "")" Size="Size.Large" Color="Color.Success" /></MudTd>
                <MudTd>@context.FileName</MudTd>
                <MudTd>@PhysicalFileService.GetFileSize(_settings, context)</MudTd>
                <MudTd>@PhysicalFileService.GetFileNumber(_settings, context)</MudTd>
                <MudTd>
                    <MudIconButton
                        Icon="@(context.ShowDetails ? Icons.Material.Filled.ExpandLess : Icons.Filled.ExpandMore)"
                        OnClick="@(() => context.ShowDetails = !context.ShowDetails)"/>
                </MudTd>
            </RowTemplate>
            <ChildRowContent>
                @if (context.ShowDetails)
                {
                    foreach (var file in PhysicalFileService.GetFileNames(_settings, context))
                    {
                        <MudTr><MudTd colspan="5">@file</MudTd></MudTr>
                    }
                }
            </ChildRowContent>
        </MudTable>
    }
}